<%#= f.fields_for :percentages, vendor.percentages.find_or_initialize_by(product: product) do |p| -%>
  <%#= p.text_area :percentage %>
  <%#= p.hidden_field :product_id, value: product.id %>
<%# end -%>

<fieldset>
  <%= f.label :name, "Vendor" %>
  <%= f.text_area :name %>
  <%= f.fields_for :percentages do |builder| %>
    <%= render "percentages_fields", f: builder %>
  <% end %>
</fieldset>